@{
    ViewData["Title"] = "Pagina";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAcesso.cshtml";
}
<!-- HEADER -->
<div class="page-header py-6 light-fg">

    <div class="d-flex flex-row align-items-center">

        <button type="button" class="sidebar-toggle-button btn btn-icon d-block d-lg-none mr-2 fuse-ripple-ready" data-fuse-bar-toggle="demo-sidebar">
            <i class="icon icon-menu"></i>
        </button>
        <span class="h4">Configuração de acesso</span>

    </div>

</div>
<!-- / HEADER -->

<div class="page-content-card">
    <!-- CONTENT TOOLBAR -->
    <div class="toolbar col p-6">
        Páginas
    </div>
    <div class="demo-content">

        <div class="p-7 col-12">
            <center>
                <table>
                    <tr>
                        <td>
                            <input id="inputPagina" type="text" class="form-control" placeholder="Nova Página" />
                        </td>
                        <td>
                            <input id="inputConstante" type="text" class="form-control" placeholder="Chave" />
                        </td>
                        <td>
                            <button class="btn btn-light btn-fab btn-sm fuse-ripple-ready" onclick="Cadastrar()"><i class="icon-plus"></i></button>
                        </td>
                    </tr>
                </table>
            </center>
        </div>
        <center>
            <div class=" p-6 col-10">
                <table id="paginaDataTable" class="table "></table>
            </div>
        </center>

    </div>
</div>
@section Scripts{
<script type="text/javascript" src="/node_modules/datatables.net/js/jquery.dataTables.js"></script>
<script type="text/javascript" src="/node_modules/datatables-responsive/js/dataTables.responsive.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        MontarDataTable();
    });
    function MontarDataTable() {

        $('#paginaDataTable').DataTable(
            {
                "sEmptyTable": "Nenhum registro encontrado",
                "sInfo": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                "sInfoEmpty": "Mostrando 0 até 0 de 0 registros",
                "sInfoFiltered": "(Filtrados de _MAX_ registros)",
                "sInfoPostFix": "",
                "sInfoThousands": ".",
                "sLengthMenu": "_MENU_ resultados por página",
                "sLoadingRecords": "Carregando...",
                "sProcessing": "Processando...",
                "sZeroRecords": "Nenhum registro encontrado",
                "sSearch": "Pesquisar",
                "oPaginate": {
                    "sNext": "Próximo",
                    "sPrevious": "Anterior",
                    "sFirst": "Primeiro",
                    "sLast": "Último"
                },
                "oAria": {
                    "sSortAscending": ": Ordenar colunas de forma ascendente",
                    "sSortDescending": ": Ordenar colunas de forma descendente"
                },
                "bDestroy": true,
                "bProcessing": true,
                "bServerSide": true,
                "sAjaxSource": "/Admin/Pagina/Listar",
                "aoColumns": [
                    {
                        "sTitle": "Código",
                        "mDataProp": "id",
                        "sWidth": "15%"
                    },
                    {
                        "sTitle": "Chave",
                        "mDataProp": "constante"
                    },
                    {
                        "sTitle": "Página",
                        "mDataProp": "desPagina"
                    }


                ],
                dom: 'rt<"dataTables_footer"ip>',

                language: {
                    lengthMenu: "Exibe _MENU_ Registros por pagina",
                    search: "Procurar",
                    paginate: { "previous": "Retornar", "next": "Avancar" },
                    zeroRecords: "Nenhum registro encontrado",
                    info: "Exibindo pagina _PAGE_ de _PAGES_",
                    infoEmpty: "Sem registros",
                    infoFiltered: "(filtrado de _MAX_ regitros totais)",
                    processing: "Aguarde Estamos Processando..."
                },

                "filter": true,            // habilita o filtro(search box)
                "lengthMenu": [[3, 5, 10, 25, 50, -1], [3, 5, 10, 25, 50, "Todos"]],

                pageLength: 5,
                scrollY: 'auto',
                scrollX: false,
                responsive: true,
                autoWidth: false,
                scrollCollapse: true

            }
        );
    }
    function Cadastrar() {
        if ($("#inputPagina").val().length > 0) {
            var dataT = {

                id: 0,
                desPagina: $("#inputPagina").val(),
                constante: $("#inputConstante").val()

            };
            var callback = function (data) {
                var pagina = JSON.parse(data);
                if (pagina.success) {
                    PNotify.success({
                        title: pagina.message
                    });
                    MontarDataTable();

                }
                else {
                    var msg = '';
                    $.each(pagina.data, function (index, item) {
                        msg = msg + item.property + ' - ' + item.message + '\n';
                    });

                    PNotify.info({
                        title: msg
                    });

                }
            };
            var callbackErro = function (data) {
                PNotify.error({
                    title: 'Ocorreu um erro ao processar sua solicitação'
                });

            };

            academia.helper.rest.utils.POST("/Admin/Pagina/Novo", dataT, callback, callbackErro, $('#loader'));
        }
        else {

            PNotify.info({
                title: 'Informe a descrição da página'
            });


        }

    }


</script>
}


