
@{
    ViewData["Title"] = "Nova";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="content custom-scrollbar ps">
    <div class="doc forms-doc page-layout simple full-width">


        <!-- HEADER -->
        <div class="page-header bg-primary text-auto row no-gutters align-items-center justify-content-between p-6">
            <div class="logo row no-gutters justify-content-center align-items-start justify-content-sm-start">
                <div class="logo-icon mr-3 mt-1">
                    <i class="icon-school s-6"></i>
                </div>
                <div class="logo-text">
                    <div class="h4">Nova Turma</div>
                </div>
            </div>

        </div>

        <div class="page-content">

            <div class="tab-pane fade show active resetForm" id="basic-info-tab-pane" role="tabpanel" aria-labelledby="basic-info-tab">

                <div class="card p-6">
                    <div class="row">
                        <div class="col-12">
                            <div class="example">


                                <div class="source-preview-wrapper">
                                    <div class="preview">
                                        <div class="preview-elements">
                                            <form id="formTurma">

                                                <div class="form-row">
                                                    <div class="form-group col-md-12">
                                                        <input type="text" class="form-control" id="inputNome" name="inputNome" placeholder="Nome">
                                                        <label for="inputNome" class="col-form-label">Nome</label>
                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <label for="TipoTurma" class="col-form-label">Tipo de turma</label>
                                                        @Html.DropDownList("TipoTurma", null, "", new { @class = "form-control   select" })


                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <input type="text" class="form-control" id="inputCodigo" name="inputCodigo" placeholder="CPF">
                                                        <label for="inputCodigo" class="col-form-label">Codigo</label>

                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <label for="Professor" class="col-form-label">Professor</label>
                                                        @Html.DropDownList("Professores", null, "", new { @class = "form-control   select" })


                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <input type="number" class="form-control" id="inputAno" name="inputAno" placeholder="Ano Turma">
                                                        <label for="inputAno" class="col-form-label">Ano</label>

                                                    </div>

                                                </div>

                                                <button type="submit" class="btn btn-primary fuse-ripple-ready">Cadastrar</button>
                                            </form>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    @section Scripts{
        <script src="~/Modulo/jquery-validation/dist/jquery.validate.js"></script>
        <script src="~/Modulo/jquery-validation/messages_pt_BR.js"></script>
        <script src="~/js/Helper/Helper.js"></script>
        <script src="~/js/Helper/CookieHelper.js"></script>
        <script>
            $(function () {
               
               
                var jvalidate = $("#formTurma").validate({
                    ignore: [],
                    rules: {

                       
                        inputNome: {
                            required: true,
                            minlength: 6,
                            maxlength: 300

                        },
                        inputCodigo: {
                            required: true,
                            minlength: 2,

                           

                        },
                       
                        Professores: {
                            required: true
                        },
                           inputAno: {
                            required: true
                        }


                    },
                    messages: {

                       
                        inputNome: {
                            required: "Informe o nome da turma.",
                            minlength: $.validator.format("O nome precisa ter pelo menos {0} characters"),
                            maxlength: $.validator.format("O nome não pode ser superior há {0} characters")

                        },
                        inputCodigo: {
                            required: "Informe o código da turma",
                            minlength: $.validator.format("O nome precisa ter pelo menos {0} characters"),
                          
                        },
                        TipoTurma: {
                            required: "Informe o tipo da turma."

                        },
                        Professores: {
                            required: "Informe o professor."

                        },
                        inputAno: {
                            required: "Informe o ano."

                        }

                    },
                    submitHandler: function (form) {
                        var dataT = {

                            Id: 0,
                            CodTurma: $("#formTurma #inputCodigo").val(),
                            DesTurma: $("#formTurma #inputNome").val(),
                            IdProfessor: $("#formTurma #Professores").val(),
                            TipoTurmaId: $("#formTurma #TipoTurma").val(),
                            Ano: $("#formTurma #inputAno").val()
                           

                        }
                        var callback = function (data) {
                            if (JSON.parse(data).success) {
                                PNotify.success({
                                    title: ':-)',
                                    text: 'Cadastro realizado com sucesso.'
                                });
                                document.getElementById("formTurma").reset();
                                return false;
                            } else {
                                var msg = '';
                                $.each(JSON.parse(data).data, function (index, item) {
                                    msg = msg + item.property + ' > ' + item.message + '\n';
                                });

                                PNotify.error({
                                    title: 'Ops! ' + JSON.parse(data).message + ' :-( ',
                                    text: msg
                                });


                            }
                        }
                        var callbackErro = function (data) {
                            PNotify.error({
                                title: 'Ops! :-(',
                                text: 'Ocorreu um erro ao processar sua solicitação'
                            });

                        }

                        academia.helper.rest.utils.POST("/Turma/Nova/", dataT, callback, callbackErro, $('#loader'));

                    }
                });
            });
        </script>
    }

</div>



